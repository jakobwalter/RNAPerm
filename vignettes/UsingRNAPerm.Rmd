---
title: "UsingRNAPerm"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{UsingRNAPerm}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(RNAPerm)

```


```{r}
### Generate data from NB distribution and put into array
Y <- rnbinom(40*100, mu = 10, size = 1/0.2)
Y <- data.frame(array(Y, dim = c(40, 100)))
X <- as.factor(rep(c("A", "B"), each = 20))
ClassicPermTest(X, Y, 100)
```


```{r}
XRecoded <- (X == X[1])*2-1
scores <- apply(Y, 2, function(YCol){
  modNull<- glm(YCol ~ 1, family = poisson)
  XRecoded*residuals(modNull, type = "response")
}
)
flipArray <- array(rbinom(20*40, size = 1, prob = 0.5)*2-1, dim = c(20,40))
flipArray[1,] <- 1
testStatistics <- flipArray %*% scores
pVals <- rowMeans(apply(testStatistics, 1, function(i) i >= testStatistics[1,]))
```

```{r}

```




```{r}
pVals
```


